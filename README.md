# 设计：
## • 运行环境设计：
        Windows10/11
	    PyCharm2021
## • 关键算法设计：
        1、计算平均缴费金额、平均缴费次数+居民客户类型归类
	       
	
	
	    2、预测高价值用户top5
	       差分自回归移动平均模型（ARIMA）。
      
       3、用户用电模型建立，为企业电力营销和调度进行决策人支撑
	       
	

## • 项目重难点：
        1、如何高效地预测出高价值用户top5
	       任务3是对多个用户进行预测，数据集Tianchi_power.csv中用户有1000多个，且每个用户有600多条时间记录，数据量太大。为了预测效率更高，
	       先根据自定义高价值用户标准（用电量大于平均用电量）对1000多个用户进行筛选，选择出属于高价值用户的132个用户；然后我在高价值用户中
	       随机抽取user_id为......分别进行测试，发现这些用户的时间序列与ARIMA模型的拟合度都非常高，残差的自相关性分别为.....,于是大胆猜测，
	       其他用户也可以用ARIMA模型进行预测。在实验中，所有非平稳时间序列一阶差分之后全部变为平稳时间序列，然后采取for循环遍历平稳时间序列
	       的user_id，采用BIC准则直接算出参数p,q值，即可预测出9月份每天的用电量。最后对所有用户预测值的平均值进行排序，得出top5。但显然这种
	       方法由于for循环效率仍然不高。
	       
        2、用户用电模型建立
	       任务4是建立模型，主要目的应该在于预测每一天中每个时间段的大概功率，考虑天气，节假日等因素的影响，应用相关数据根据对每天每个时段的
	       用电量分析，最后以月为单位， 进行用户用电预测。在对不同时间段等因素进行聚类分析的时候，如果随机选取聚类中心容i使得结果不理想。我们
	       对聚类中心的选择做出改进。首先选择中心然后得出中心与每个点之间的距离，不断聚类，直到中心选取完成。

## • 代码结构设计：


# 知识原理：
	  
# 方案实现：
## • 已完成
	1、计算平均缴费金额、平均缴费次数
	
		
	2、居民客户类型归类
		
	
	3、预测高价值用户top5
	
	
	4、电力用户模型
	
	
	5、电力客户行为分析
		

# 模型优化：
    1、任务3：ARIMA模型参数的选择
        ○ 代替通过观察acf图和pacf图得到参数p,q的值，采取AIC/BIC准则直接获取p,q值，更为准确；
	    ○ 同时采用BIC准则代替AIC准则，弥补了AIC在样本数据量过大时，模型精度过高导致的模型复杂度过高的不足，以此达到最优化
    2、任务4：对初始聚类中心的选择做出改进
         首先把初始聚类中心数确定，然后进行聚类中心的选择。设算法已完成i个中心的选取，在选择下一个中心时，若此点距离当前i个中心点越远，
	 则其被选概率越大。但如果i为1，则此算法与未改进前一样，即聚类中心随机选取。换句话说，算法改进前后的区别在于对初始点的处理
    3、任务5：k-means聚类模型
        通过用电曲线特征进行聚类的簇的划分，最终得出对于这组数据选择两簇


# 分析评估：
    1、任务3：利用D-W检验, 检验残差的自相关性
        ○ 当D-W检验值接近于2时，不存在自相关性，说明模型较好
	    ○ 代码运行结果表明，对于不同的高价值用户D-W检验值都在2周围波动，范围为1.94~2.06，模型较好
    2、任务4
        ○ 检验总样本量，总特征数
	○ 利用非监督式评估方法，计算平均轮廓系数，calinski和harabaz得分，silhouette_s大于0.5，说明聚类质量较优
	  优秀与否的基本原则是不同类别间是否具有显著的区分效果。
    3、任务5
        1、对于用电特征的选取为将所获取数据的每天缴费的电量用用电曲线表示
        2、将用电曲线作为一种特征进行聚类的划分
        3、最终分得两组聚类
	
	
# 运行/部署：

# 数据来源：
	• cph.xlsx                             
		○ 示例数据集
	• Tianchi_power.csv 
		○ https://mp.weixin.qq.com/s?__biz=MzIxNjE1Njg4OA==&mid=100000074&idx=1&sn=3073ebdfd0a081cb6485e7f6c0e9afc9&chksm=178c1efd20fb97eb04586d0f6757f40eee42170a1d71196762cc33751a25df75adbc5d329821&mpshare=1&scene=23&srcid=0518olygZZCnGt2yLNZkepYU&sharer_sharetime=1652861545327&sharer_shareid=32db0bc2d3c4c22843f068f1a5ea1660#rd
          2015.01.01—2016.08.31中国江苏省扬中市1000多家企业每日用电量数据
        • 数据集.xlsx                             
		○ 示例数据集
   
